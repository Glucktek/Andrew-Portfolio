---
// components
import NavLink from "@components/nav/NavLink.astro";
import NavDropdownToggle from "@components/nav/NavDropdown/NavDropdownToggle.astro";
import MegaMenuDropdownToggle from "./NavDropdown/MegaMenuDropdownToggle.astro";
import MobileNav from "@components/nav/MobileNav/MobileNav.astro";
import SiteLogo from "@components/site-logo/SiteLogo.astro";
import Button from "@components/button/Button.astro";
import LanguageSelect from "@components/language-select/LanguageSelect.astro";

import SocialIconSimple from "@components/social/SocialIconSimple.astro";
import socialLinks from "@config/socialLinks.json.ts";

// utils
import { getLocaleFromUrl } from "@js/localeUtils";
import { getTranslatedData } from "@js/translationUtils";

// data
const currLocale = getLocaleFromUrl(Astro.url);
const navData = getTranslatedData("navData", currLocale);
import { locales } from "@config/siteSettings.json";
// console.log(JSON.stringify(navData, null, 2));
---

<section
  id="nav"
  class="navbar--initial dark bg-background/80 border-border/50 fixed top-0 left-0 z-30 flex w-full flex-col border-b py-3 backdrop-blur-sm transition-all duration-300"
>
  <div class="mx-auto flex w-full">
    <div class="site-container flex w-full items-center">
      <header class="relative flex w-full items-center gap-2">
        <!-- home button / image -->
        <div class="flex h-full flex-auto justify-start">
          <SiteLogo />
        </div>

        <!-- <div class="flex flex-auto justify-center">
          
        </div> -->

        <!-- desktop nav menu -->
        <div>
          <div class="flex h-full flex-auto justify-end gap-2">
            <div class="hidden md:flex items-center">
              <nav>
                <ul class="flex h-full items-center gap-6 pr-[5px]">
                  {
                    navData.map((navItem) =>
                      "dropdown" in navItem ? (
                        <NavDropdownToggle navItem={navItem} />
                      ) : "megaMenuColumns" in navItem ? (
                        <MegaMenuDropdownToggle {navItem} />
                      ) : (
                        <NavLink {navItem} />
                      ),
                    )
                  }
                </ul>
              </nav>
              <div class="flex items-center gap-2 ml-6 leading-tight">
                {socialLinks.map((s) => <SocialIconSimple {...s} class="h-4 w-4" />)}
              </div>
            </div>
            <div class="hidden items-center gap-3 md:flex pl-3">
              {locales.length > 1 && <LanguageSelect class="" />}
            </div>

            <!-- mobile nav menu, only load on small screens where it is visible -->
            <div class="flex items-center md:hidden">
              <MobileNav />
            </div>
          </div>
        </div>
      </header>
    </div>
  </div>
</section>
